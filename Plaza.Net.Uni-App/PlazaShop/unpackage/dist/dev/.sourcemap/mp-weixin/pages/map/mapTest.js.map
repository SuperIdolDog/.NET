{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/Lenovo/Desktop/CSharp项目/就业项目/Plaza/Plaza.Net.Uni-App/PlazaShop/pages/map/mapTest.vue?8c0e","webpack:///C:/Users/Lenovo/Desktop/CSharp项目/就业项目/Plaza/Plaza.Net.Uni-App/PlazaShop/pages/map/mapTest.vue?b2dd","webpack:///C:/Users/Lenovo/Desktop/CSharp项目/就业项目/Plaza/Plaza.Net.Uni-App/PlazaShop/pages/map/mapTest.vue?5d8a","webpack:///C:/Users/Lenovo/Desktop/CSharp项目/就业项目/Plaza/Plaza.Net.Uni-App/PlazaShop/pages/map/mapTest.vue?90ac","uni-app:///pages/map/mapTest.vue","webpack:///C:/Users/Lenovo/Desktop/CSharp项目/就业项目/Plaza/Plaza.Net.Uni-App/PlazaShop/pages/map/mapTest.vue?c087","webpack:///C:/Users/Lenovo/Desktop/CSharp项目/就业项目/Plaza/Plaza.Net.Uni-App/PlazaShop/pages/map/mapTest.vue?34c3"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","selectedCity","hasUserSelectedCity","mapHeight","minMapHeight","maxMapHeight","scale","scrollTop","lastScrollTop","searchKey","currentLocation","latitude","longitude","plazas","markers","myLocationMarker","computed","sortedplazas","list","onLoad","onShow","uni","methods","loadplazas","title","url","method","lat","lng","city","page","size","res","icon","reverseCity","province","zoomIn","zoomOut","handleScroll","selectplaza","id","name","initMarkers","iconPath","width","height","callout","content","color","fontSize","borderRadius","bgColor","padding","display","getUserLocation","type","success","fail","_getLocationOnly","resolve","setMyLocationMarker","anchor","x","y","useBeijingFallback","handleSearch","navigateToCity"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,gBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAgI;AAChI;AAC2D;AACL;AACsC;;;AAG5F;AACgL;AAChL,gBAAgB,yLAAU;AAC1B,EAAE,6EAAM;AACR,EAAE,8FAAM;AACR,EAAE,uGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,kGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,iSAEN;AACP,KAAK;AACL;AACA,aAAa,iSAEN;AACP,KAAK;AACL;AACA,aAAa,6SAEN;AACP,KAAK;AACL;AACA,aAAa,uSAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACzDA;AAAA;AAAA;AAAA;AAAwpB,CAAgB,6qBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eCmF5qB;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;QAAAC;QAAAC;MAAA;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACA;MACA;QACA;QACAC;UAAA;QAAA;MACA;MACA;QAAA;MAAA;IACA;EACA;EACAC;IACA;MACA;MACA;IACA;IACA;EACA;EACAC;IAAA;IACAC;MACA;MACA;MACA;IACA;EACA;EACAC;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBACAF;kBAAAG;gBAAA;gBAAA;gBAAA;gBAAA,OAEAH;kBACAI;kBACAC;kBACA1B;oBACA2B;oBACAC;oBACAC;oBACAC;oBACAC;kBACA;gBACA;cAAA;gBAVAC;gBAWA;kBACA;kBACA;gBACA;kBACAX;oBAAAG;oBAAAS;kBAAA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAZ;kBAAAG;kBAAAS;gBAAA;cAAA;gBAAA;gBAEAZ;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACAa;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAEAb;kBACAI;kBACAC;kBACA1B;oBAAA2B;oBAAAC;kBAAA;gBACA;cAAA;gBAJAI;gBAAA,MAKAA;kBAAA;kBAAA;gBAAA;gBACAH;gBACAM;gBAAA,MACAN;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAAA,kCACAA;cAAA;gBAAA,kCAEA;cAAA;gBAAA;gBAAA;gBAAA,kCAEA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACAO;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;MACA;QACA;MACA;QACA;MACA;MACA;IACA;IACAC;MACAlB;QACAmB;QACAC;QACAZ;MACA;MACAR;MACAA;IACA;IACAqB;MAAA;MACA;MACA;MACA;QAAA,OACA;UACAF;UACA7B;UACAC;UACA+B;UACAC;UACAC;UACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;UACA;QACA;MAAA,EACA;IACA;IACAC;MAAA;MA+BAjC;QACAkC;QACAC;UAAA;YAAA;cAAA;gBAAA;kBAAA;oBACAnC;sBAAAG;sBAAAS;oBAAA;oBACA;sBAAAtB;sBAAAC;oBAAA;oBAAA;oBAAA,OACA;kBAAA;oBAAA;oBACA;oBACA;oBACA;kBAAA;kBAAA;oBAAA;gBAAA;cAAA;YAAA;UAAA,CACA;UAAA;YAAA;UAAA;UAAA;QAAA;QACA6C;UACApC;YAAAG;YAAAS;UAAA;UACA;QACA;MACA;IAEA;IACAyB;MAAA;MACA;QAmBArC;UACAkC;UACAC;YACA;cAAA7C;cAAAC;YAAA;YACA;YACA;YACA+C;UACA;UACAF;QACA;MAEA;IACA;IACAG;MACA;QACApB;QACA7B;QACAC;QACA+B;QACAC;QACAC;QACAgB;UAAAC;UAAAC;QAAA;MACA;MACA;IACA;IACAC;MACA;QAAArD;QAAAC;MAAA;MACA;MACA;MACA;IACA;IACAqD;IACAC;MACA7C;QACAI;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACrUA;AAAA;AAAA;AAAA;AAAuwC,CAAgB,ouCAAG,EAAC,C;;;;;;;;;;;ACA3xC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/map/mapTest.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/map/mapTest.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./mapTest.vue?vue&type=template&id=705870f2&scoped=true&\"\nvar renderjs\nimport script from \"./mapTest.vue?vue&type=script&lang=js&\"\nexport * from \"./mapTest.vue?vue&type=script&lang=js&\"\nimport style0 from \"./mapTest.vue?vue&type=style&index=0&id=705870f2&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"705870f2\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/map/mapTest.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./mapTest.vue?vue&type=template&id=705870f2&scoped=true&\"","var components\ntry {\n  components = {\n    uIcon: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uview-ui/components/u-icon/u-icon\" */ \"@/uni_modules/uview-ui/components/u-icon/u-icon.vue\"\n      )\n    },\n    uText: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uview-ui/components/u-text/u-text\" */ \"@/uni_modules/uview-ui/components/u-text/u-text.vue\"\n      )\n    },\n    uSearch: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uview-ui/components/u-search/u-search\" */ \"@/uni_modules/uview-ui/components/u-search/u-search.vue\"\n      )\n    },\n    uEmpty: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uview-ui/components/u-empty/u-empty\" */ \"@/uni_modules/uview-ui/components/u-empty/u-empty.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.sortedplazas.length\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./mapTest.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./mapTest.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"page\">\n    <!-- 地图容器 -->\n    <view class=\"map-container\" :style=\"{ height: `${mapHeight}px` }\">\n      <map\n        id=\"plazaMap\"\n        class=\"map\"\n        :latitude=\"currentLocation.latitude\"\n        :longitude=\"currentLocation.longitude\"\n        :markers=\"markers\"\n        :show-location=\"true\"\n        :enable-zoom=\"true\"\n        :enable-scroll=\"true\"\n        :enable-rotate=\"false\"\n        :scale=\"scale\"\n        :min-scale=\"3\"\n        :max-scale=\"20\"\n      />\n      <view class=\"locate-btn\" @tap=\"getUserLocation\">\n        <u-icon name=\"map-fill\" color=\"#333\" size=\"20\" />\n      </view>\n      <view class=\"zoom-controls\">\n        <view class=\"zoom-btn\" @tap=\"zoomOut\"><u-icon name=\"plus\" color=\"#333\" size=\"20\" /></view>\n        <view class=\"zoom-btn\" @tap=\"zoomIn\"><u-icon name=\"minus\" color=\"#333\" size=\"20\" /></view>\n      </view>\n    </view>\n\n    <!-- 广场列表 -->\n    <view class=\"plaza-list-container\" :style=\"{ top: `${mapHeight - 30}px` }\">\n      <view class=\"search-section\">\n        <view class=\"search-bar\">\n          <view class=\"search-content\">\n            <view class=\"city-selector\" @click=\"navigateToCity\">\n              <u-text class=\"city-text\" :text=\"selectedCity\" />\n              <u-icon name=\"arrow-down\" size=\"12\" color=\"#666\" />\n            </view>\n            <u-search\n              v-model=\"searchKey\"\n              placeholder=\"搜索广场\"\n              shape=\"round\"\n              bgColor=\"#f8f9fa\"\n              :showAction=\"false\"\n              @search=\"handleSearch\"\n              @clear=\"handleSearch\"\n            />\n          </view>\n        </view>\n      </view>\n\n      <scroll-view\n        class=\"plaza-list\"\n        :style=\"{ height: `calc(100vh - ${mapHeight}px - 120rpx)` }\"\n        scroll-y\n        @scroll=\"handleScroll\"\n        :scroll-top=\"scrollTop\"\n      >\n        <view class=\"list-center\">\n          <view\n            v-for=\"plaza in sortedplazas\"\n            :key=\"plaza.id\"\n            class=\"plaza-card\"\n            @click=\"selectplaza(plaza)\"\n          >\n            <view class=\"plaza-info\">\n              <view class=\"plaza-header\">\n                <u-text class=\"plaza-name\" :text=\"plaza.name\" />\n                <u-text class=\"plaza-distance\" :text=\"plaza.distance + 'km'\" align=\"right\" />\n              </view>\n              <view class=\"plaza-address\">{{ plaza.address }}</view>\n            </view>\n            <u-icon name=\"arrow-right\" size=\"16\" color=\"#ccc\" />\n          </view>\n\n          <view v-if=\"!sortedplazas.length\" class=\"empty-state\">\n            <u-empty mode=\"list\" marginTop=\"120rpx\" />\n          </view>\n        </view>\n      </scroll-view>\n    </view>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      selectedCity: '正在定位中...',\n      hasUserSelectedCity: false,\n      mapHeight: 350,\n      minMapHeight: 120,\n      maxMapHeight: 400,\n      scale: 16,\n      scrollTop: 0,\n      lastScrollTop: 0,\n      searchKey: '',\n      currentLocation: { latitude: 39.904956, longitude: 116.389449 },\n      plazas: [],\n      markers: [],\n      myLocationMarker: null\n    };\n  },\n  computed: {\n    sortedplazas() {\n      let list = [...this.plazas];\n      if (this.searchKey.trim()) {\n        const kw = this.searchKey.trim().toLowerCase();\n        list = list.filter((s) => s.name.toLowerCase().includes(kw));\n      }\n      return list.sort((a, b) => a.distance - b.distance);\n    }\n  },\n  onLoad(options) {\n    if (options && options.city) {\n      this.selectedCity = decodeURIComponent(options.city);\n      this.hasUserSelectedCity = true;\n    }\n    this.getUserLocation();\n  },\n  onShow() {\n    uni.$once('citySelected', (city) => {\n      this.selectedCity = city;\n      this.hasUserSelectedCity = true;\n      this.loadplazas();\n    });\n  },\n  methods: {\n    async loadplazas() {\n      if (!this.currentLocation.latitude) return;\n      uni.showLoading({ title: '加载中' });\n      try {\n        const res = await uni.request({\n          url: '/api/plaza/nearby',\n          method: 'GET',\n          data: {\n            lat: this.currentLocation.latitude,\n            lng: this.currentLocation.longitude,\n            city: this.selectedCity,\n            page: 1,\n            size: 50\n          }\n        });\n        if (res.data.success) {\n          this.plazas = res.data.data || [];\n          this.initMarkers();\n        } else {\n          uni.showToast({ title: '获取门店数据失败', icon: 'none' });\n        }\n      } catch {\n        uni.showToast({ title: '获取门店失败', icon: 'none' });\n      } finally {\n        uni.hideLoading();\n      }\n    },\n    async reverseCity(lat, lng) {\n      try {\n        const res = await uni.request({\n          url: '/api/plaza/city',\n          method: 'GET',\n          data: { lat, lng }\n        });\n        if (res.data.status === 0 && res.data.result) {\n          let city = res.data.result.address_component.city;\n          const province = res.data.result.address_component.province;\n          if (city.endsWith('市辖区') && province) return province;\n          return city;\n        }\n        return '未知城市';\n      } catch {\n        return '未知城市';\n      }\n    },\n    zoomIn() {\n      if (this.scale < 20) this.scale += 1;\n    },\n    zoomOut() {\n      if (this.scale > 3) this.scale -= 1;\n    },\n    handleScroll(e) {\n      const scrollTop = e.detail.scrollTop;\n      const deltaY = scrollTop - this.lastScrollTop;\n      if (deltaY > 0 && this.mapHeight > this.minMapHeight) {\n        this.mapHeight = Math.max(this.minMapHeight, this.mapHeight - deltaY * 0.5);\n      } else if (deltaY < 0 && this.mapHeight < this.maxMapHeight) {\n        this.mapHeight = Math.min(this.maxMapHeight, this.mapHeight - deltaY * 0.5);\n      }\n      this.lastScrollTop = scrollTop;\n    },\n    selectplaza(plaza) {\n      uni.setStorageSync('selectedPlaza', {\n        id: plaza.id,\n        name: plaza.name,\n        city: plaza.city\n      });\r\n\t   uni.$emit('plazaSelected', plaza);\n      uni.navigateBack();\n    },\n    initMarkers() {\n      this.markers = [];\n      if (this.myLocationMarker) this.markers.push(this.myLocationMarker);\n      this.plazas.forEach((s) =>\n        this.markers.push({\n          id: s.id,\n          latitude: s.latitude,\n          longitude: s.longitude,\n          iconPath: '/static/location.png',\n          width: 30,\n          height: 30,\n          callout: {\n            content: s.name,\n            color: '#333',\n            fontSize: 12,\n            borderRadius: 4,\n            bgColor: '#ffffff',\n            padding: 5,\n            display: 'ALWAYS'\n          }\n        })\n      );\n    },\n    getUserLocation() {\n      // #ifdef H5\n      if (this.hasUserSelectedCity) {\n        this._getLocationOnly();\n        return;\n      }\n      if (!navigator.geolocation) {\n        uni.showToast({ title: '浏览器不支持定位', icon: 'none' });\n        this.useBeijingFallback();\n        return;\n      }\n      navigator.geolocation.getCurrentPosition(\n        async (pos) => {\n          const { latitude, longitude } = pos.coords;\n          uni.showToast({ title: '定位成功', icon: 'success' });\n          this.currentLocation = { latitude, longitude };\n          this.selectedCity = await this.reverseCity(latitude, longitude);\n          this.hasUserSelectedCity = false;\n          this.loadplazas();\n          this.setMyLocationMarker(latitude, longitude);\n          this.initMarkers();\n        },\n        () => {\n          uni.showToast({ title: '定位失败，使用北京', icon: 'none' });\n          this.useBeijingFallback();\n        },\n        { enableHighAccuracy: true, timeout: 10000 }\n      );\n      // #endif\n\n      // #ifndef H5\n      uni.getLocation({\n        type: 'gcj02',\n        success: async (res) => {\n          uni.showToast({ title: '定位成功', icon: 'success' });\n          this.currentLocation = { latitude: res.latitude, longitude: res.longitude };\n          this.selectedCity = await this.reverseCity(res.latitude, res.longitude);\n          this.hasUserSelectedCity = false;\n          this.loadplazas();\n          this.setMyLocationMarker(res.latitude, res.longitude);\n        },\n        fail: () => {\n          uni.showToast({ title: '定位失败，使用北京', icon: 'none' });\n          this.useBeijingFallback();\n        }\n      });\n      // #endif\n    },\n    _getLocationOnly() {\n      return new Promise((resolve) => {\n        // #ifdef H5\n        if (!navigator.geolocation) {\n          resolve();\n          return;\n        }\n        navigator.geolocation.getCurrentPosition(\n          (pos) => {\n            const { latitude, longitude } = pos.coords;\n            this.currentLocation = { latitude, longitude };\n            this.setMyLocationMarker(latitude, longitude);\n            this.loadplazas();\n            resolve();\n          },\n          () => resolve()\n        );\n        // #endif\n\n        // #ifndef H5\n        uni.getLocation({\n          type: 'gcj02',\n          success: (res) => {\n            this.currentLocation = { latitude: res.latitude, longitude: res.longitude };\n            this.setMyLocationMarker(res.latitude, res.longitude);\n            this.loadplazas();\n            resolve();\n          },\n          fail: resolve\n        });\n        // #endif\n      });\n    },\n    setMyLocationMarker(lat, lng) {\n      this.myLocationMarker = {\n        id: 999,\n        latitude: lat,\n        longitude: lng,\n        iconPath: '/static/my-location.png',\n        width: 36,\n        height: 36,\n        anchor: { x: 0.5, y: 0.5 }\n      };\n      this.initMarkers();\n    },\n    useBeijingFallback() {\n      this.currentLocation = { latitude: 39.904956, longitude: 116.389449 };\n      this.selectedCity = '北京市';\n      this.hasUserSelectedCity = false;\n      this.loadplazas();\n    },\n    handleSearch() {},\n    navigateToCity() {\n      uni.navigateTo({\n        url: `/pages/map/choosecity?city=${encodeURIComponent(this.selectedCity)}`\n      });\n    }\n  }\n};\n</script>\n<style lang=\"scss\" scoped>\n.page {\n  height: 100vh;\n  background-color: #f8f9fa;\n  position: relative;\n}\n\n.map-container {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 10;\n  background-color: #fff;\n  transition: height 0.3s ease-out;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n\n  .map {\n    width: 100%;\n    height: 100%;\n  }\n\n  .locate-btn {\n    position: absolute;\n    right: 30rpx;\n    bottom: 80rpx;\n    width: 80rpx;\n    height: 80rpx;\n    background: #fff;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.15);\n    transition: all 0.3s ease;\n\n    &:active {\n      transform: scale(0.95);\n    }\n  }\n\n  .zoom-controls {\n    position: absolute;\n    right: 30rpx;\n    bottom: 180rpx;\n    display: flex;\n    flex-direction: column;\n    gap: 20rpx;\n    z-index: 100;\n\n    .zoom-btn {\n      width: 80rpx;\n      height: 80rpx;\n      background: #fff;\n      border-radius: 50%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 36rpx;\n      font-weight: bold;\n      color: #333;\n      box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.15);\n    }\n  }\n}\n\n.plaza-list-container {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 20;\n  background-color: #fff;\n  border-radius: 24rpx 24rpx 0 0;\n  box-shadow: 0 -4rpx 20rpx rgba(0, 0, 0, 0.08);\n  transition: top 0.3s ease-out;\n}\n\n.search-section {\n  position: sticky;\n  top: 0;\n  z-index: 30;\n  background-color: #fff;\n  border-radius: 24rpx 24rpx 0 0;\n  padding: 20rpx 30rpx 30rpx;\n  border-bottom: 1rpx solid #f0f0f0;\n}\n\n.search-bar {\n  .search-content {\n    display: flex;\n    align-items: center;\n    gap: 20rpx;\n  }\n\n  .city-selector {\n    display: flex;\n    align-items: center;\n    gap: 8rpx;\n    padding: 16rpx 20rpx;\n    background-color: #f8f9fa;\n    border-radius: 20rpx;\n    border: 1rpx solid #e9ecef;\n\n    .city-text {\n      font-size: 28rpx;\n      color: #333;\n      font-weight: 500;\n    }\n  }\n\n  .search-box {\n    flex: 1;\n  }\n}\n\n.plaza-list {\n  padding: 0 30rpx;\n  background-color: #fff;\r\n  box-sizing: border-box;\n}\n.list-center {\n  display: flex;\n  flex-direction: column;\n  align-items: center;   /* 水平居中 */\n  padding: 20rpx 0;      /* 上下留白 */\n}\n.plaza-card {\n  width: 92%;\r\n   max-width: 700rpx;\r\n   margin: 0 auto 20rpx auto; // 👈 关键修复\r\n   padding: 30rpx 24rpx;\r\n   background: #fff;\r\n   border-radius: 20rpx;\r\n   box-shadow: 0 8rpx 20rpx rgba(0, 0, 0, 0.06);\r\n   display: flex;\r\n   align-items: center;\r\n   transition: transform 0.2s ease;\n  &:last-child {\n    border-bottom: none;\n  }\n\n  &:active {\n    background-color: #f8f9fa;\n    transform: translateX(4rpx);\n  }\n\n  .plaza-image {\n    margin-right: 24rpx;\n    flex-shrink: 0;\n  }\n\n  .plaza-info {\n    flex: 1;\n    min-width: 0;\n\n    .plaza-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: flex-start;\n      margin-bottom: 12rpx;\n\n      .plaza-name {\n        font-size: 32rpx;\n        font-weight: 600;\n        color: #333;\n        line-height: 1.4;\n        flex: 1;\n        margin-right: 16rpx;\n      }\n\n      .plaza-distance {\n        font-size: 26rpx;\n        color: #ff6b35;\n        font-weight: 500;\n        flex-shrink: 0;\n      }\n    }\n\n    .plaza-status {\n      margin-bottom: 12rpx;\n    }\n\n    .plaza-address {\n      font-size: 26rpx;\n      color: #666;\n      line-height: 1.5;\n      margin-bottom: 12rpx;\n    }\n\n    .plaza-meta {\n      display: flex;\n      align-items: center;\n      gap: 16rpx;\n      margin-bottom: 12rpx;\n\n      .business-time {\n        font-size: 24rpx;\n        color: #999;\n      }\n\n      .takeaway-tag {\n        font-size: 22rpx;\n        color: #1890ff;\n        background-color: #e6f7ff;\n        padding: 4rpx 12rpx;\n        border-radius: 12rpx;\n        border: 1rpx solid #91d5ff;\n      }\n    }\n\n    .plaza-contact {\n      display: flex;\n      align-items: center;\n      gap: 8rpx;\n\n      .phone-text {\n        font-size: 26rpx;\n        color: #ff6b35;\n      }\n    }\n  }\n\n  .select-btn {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 60rpx;\n    height: 60rpx;\n    margin-left: 16rpx;\n    flex-shrink: 0;\n  }\n}\n\n.empty-state {\n  padding: 60rpx 0;\n}\n</style>","import mod from \"-!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./mapTest.vue?vue&type=style&index=0&id=705870f2&lang=scss&scoped=true&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./mapTest.vue?vue&type=style&index=0&id=705870f2&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1755959992790\n      var cssReload = require(\"D:/HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}