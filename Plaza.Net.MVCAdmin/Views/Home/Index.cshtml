@using Microsoft.AspNetCore.Identity
@using Plaza.Net.Model.ViewModels
@model IndexViewModel;
@using System.Security.Claims
@{
    ViewData["Title"] = "后台管理系统";
}

 
<div class="lyear-layout-web">

	<div class="lyear-layout-container">
		<!--左侧导航-->
		<aside class="lyear-layout-sidebar">
			<!-- logo -->
			<div id="logo" class="sidebar-header">
                <div id="logo" class="sidebar-header">
                    <a href="index.html"><img src="~/images/BPlaza.png" title="Plaza" alt="Plaza" /></a>
                </div>
			</div>
			<div class="lyear-layout-sidebar-info lyear-scroll">
                <nav class="sidebar-main">
                    <ul class="nav-drawer">
                        @if (!Model.MenuItems.Any())
                        {
                            <div class="alert alert-warning">
                                <i class="mdi mdi-alert-circle"></i>
                                当前用户没有任何菜单权限，请联系管理员
                            </div>
                        }
                        else
                        {
                            @foreach (var item in Model.MenuItems.DistinctBy(m => m.Id))
                            {
                                <li class="nav-item @(item.Children?.Count > 0 ? "nav-item-has-subnav" : "") @(item.Name == "首页" ? "active" : "")">
                                    @if (item.Children?.Count == 0)
                                    {
                                        <a class="multitabs" href="@item.Url">
                                            <i class="@item.Icon"></i>
                                            <span>@item.Name</span>
                                        </a>
                                    }
                                    else
                                    {
                                        <a href="javascript:void(0)" class="subnav-toggle">
                                            <i class="@item.Icon"></i>
                                            <span>@item.Name</span>
                                        </a>
                                        <ul class="nav nav-subnav">
                                            @foreach (var subItem in item.Children!.DistinctBy(m => m.Id))
                                            {
                                                <li class="nav-item @(subItem.Children?.Count > 0 ? "nav-item-has-subnav" : "")">
                                                    @if (subItem.Children?.Count == 0)
                                                    {
                                                        <a class="multitabs" href="@subItem.Url">
                                                            <i class="@subItem.Icon"></i>
                                                            <span>@subItem.Name</span>
                                                        </a>
                                                    }
                                                    else
                                                    {
                                                        <a href="javascript:void(0)" class="subnav-toggle">
                                                            <i class="@subItem.Icon"></i>
                                                            <span>@subItem.Name</span>
                                                        </a>
                                                        <ul class="nav nav-subnav">
                                                            @foreach (var childItem in subItem.Children!.DistinctBy(m => m.Id))
                                                            {
                                                                <li class="nav-item">
                                                                    <a class="multitabs" href="@childItem.Url">
                                                                        <i class="@childItem.Icon"></i>
                                                                        <span>@childItem.Name</span>
                                                                    </a>
                                                                </li>
                                                            }
                                                        </ul>
                                                    }
                                                </li>
                                            }
                                        </ul>
                                    }
                                </li>
                            }
                        }
                    </ul>
                </nav>
				<div class="sidebar-footer">
					<p class="copyright">
						<span>Copyright &copy; 2025. </span>
						<a target="_blank" href="http://www.bixiaguangnian.com">BootStrapMVC Plaza</a>
					</p>
				</div>
			</div>

		</aside>
		<!--End 左侧导航-->
		<!--头部信息-->
		<header class="lyear-layout-header">

			<nav class="navbar">

				<div class="navbar-left">
					<div class="lyear-aside-toggler">
						<span class="lyear-toggler-bar"></span>
						<span class="lyear-toggler-bar"></span>
						<span class="lyear-toggler-bar"></span>
					</div>
				</div>

				<ul class="navbar-right d-flex align-items-center">
					<!--顶部消息部分-->
					<li class="dropdown dropdown-notice">
						<span data-bs-toggle="dropdown" class="position-relative icon-item">
							<i class="mdi mdi-bell-outline fs-5"></i>
                            @if(Model.NotificationCount!=0){
                                <span class="position-absolute translate-middle badge bg-danger">@Model.NotificationCount</span>
                            }
                            else{
                                <span class="position-absolute translate-middle badge bg-success">@Model.NotificationCount</span>
                            }
      
						</span>
						<div class="dropdown-menu dropdown-menu-end">
							<div class="lyear-notifications">

								<div class="lyear-notifications-title d-flex justify-content-between"
									data-stopPropagation="true">
									<span>你有 @Model.NotificationCount 条未读消息</span>
									<a href="#!">查看全部</a>
								</div>
								<div class="lyear-notifications-info lyear-scroll">
                                    @foreach(var not in Model.Notifications){
                                        <a href="@not.Link" class="dropdown-item"
                                           title="@not.Title">@not.Content</a>
                                    }
								</div>

							</div>
						</div>
					</li>
					<!--End 顶部消息部分-->
					<!--切换主题配色-->
					<li class="dropdown dropdown-skin">
						<span data-bs-toggle="dropdown" class="icon-item">
							<i class="mdi mdi-palette fs-5"></i>
						</span>
						<ul class="dropdown-menu dropdown-menu-end" data-stopPropagation="true">
							<li class="lyear-skin-title">
								<p>主题</p>
							</li>
							<li class="lyear-skin-li clearfix">
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="site_theme" id="site_theme_1"
										value="default" checked="checked">
									<label class="form-check-label" for="site_theme_1"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="site_theme" id="site_theme_2"
										value="translucent-green">
									<label class="form-check-label" for="site_theme_2"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="site_theme" id="site_theme_3"
										value="translucent-blue">
									<label class="form-check-label" for="site_theme_3"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="site_theme" id="site_theme_4"
										value="translucent-yellow">
									<label class="form-check-label" for="site_theme_4"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="site_theme" id="site_theme_5"
										value="translucent-red">
									<label class="form-check-label" for="site_theme_5"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="site_theme" id="site_theme_6"
										value="translucent-pink">
									<label class="form-check-label" for="site_theme_6"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="site_theme" id="site_theme_7"
										value="translucent-cyan">
									<label class="form-check-label" for="site_theme_7"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="site_theme" id="site_theme_8"
										value="dark">
									<label class="form-check-label" for="site_theme_8"></label>
								</div>
							</li>
							<li class="lyear-skin-title">
								<p>LOGO</p>
							</li>
							<li class="lyear-skin-li clearfix">
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="logo_bg" id="logo_bg_1"
										value="default" checked="checked">
									<label class="form-check-label" for="logo_bg_1"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="logo_bg" id="logo_bg_2"
										value="color_2">
									<label class="form-check-label" for="logo_bg_2"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="logo_bg" id="logo_bg_3"
										value="color_3">
									<label class="form-check-label" for="logo_bg_3"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="logo_bg" id="logo_bg_4"
										value="color_4">
									<label class="form-check-label" for="logo_bg_4"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="logo_bg" id="logo_bg_5"
										value="color_5">
									<label class="form-check-label" for="logo_bg_5"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="logo_bg" id="logo_bg_6"
										value="color_6">
									<label class="form-check-label" for="logo_bg_6"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="logo_bg" id="logo_bg_7"
										value="color_7">
									<label class="form-check-label" for="logo_bg_7"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="logo_bg" id="logo_bg_8"
										value="color_8">
									<label class="form-check-label" for="logo_bg_8"></label>
								</div>
							</li>
							<li class="lyear-skin-title">
								<p>头部</p>
							</li>
							<li class="lyear-skin-li clearfix">
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="header_bg" id="header_bg_1"
										value="default" checked="checked">
									<label class="form-check-label" for="header_bg_1"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="header_bg" id="header_bg_2"
										value="color_2">
									<label class="form-check-label" for="header_bg_2"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="header_bg" id="header_bg_3"
										value="color_3">
									<label class="form-check-label" for="header_bg_3"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="header_bg" id="header_bg_4"
										value="color_4">
									<label class="form-check-label" for="header_bg_4"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="header_bg" id="header_bg_5"
										value="color_5">
									<label class="form-check-label" for="header_bg_5"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="header_bg" id="header_bg_6"
										value="color_6">
									<label class="form-check-label" for="header_bg_6"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="header_bg" id="header_bg_7"
										value="color_7">
									<label class="form-check-label" for="header_bg_7"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="header_bg" id="header_bg_8"
										value="color_8">
									<label class="form-check-label" for="header_bg_8"></label>
								</div>
							</li>
							<li class="lyear-skin-title">
								<p>侧边栏</p>
							</li>
							<li class="lyear-skin-li clearfix">
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="sidebar_bg" id="sidebar_bg_1"
										value="default" checked="checked">
									<label class="form-check-label" for="sidebar_bg_1"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="sidebar_bg" id="sidebar_bg_2"
										value="color_2">
									<label class="form-check-label" for="sidebar_bg_2"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="sidebar_bg" id="sidebar_bg_3"
										value="color_3">
									<label class="form-check-label" for="sidebar_bg_3"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="sidebar_bg" id="sidebar_bg_4"
										value="color_4">
									<label class="form-check-label" for="sidebar_bg_4"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="sidebar_bg" id="sidebar_bg_5"
										value="color_5">
									<label class="form-check-label" for="sidebar_bg_5"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="sidebar_bg" id="sidebar_bg_6"
										value="color_6">
									<label class="form-check-label" for="sidebar_bg_6"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="sidebar_bg" id="sidebar_bg_7"
										value="color_7">
									<label class="form-check-label" for="sidebar_bg_7"></label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio" name="sidebar_bg" id="sidebar_bg_8"
										value="color_8">
									<label class="form-check-label" for="sidebar_bg_8"></label>
								</div>
							</li>
						</ul>
					</li>
					<!--End 切换主题配色-->
					<!--个人头像内容-->
					<li class="dropdown">
						<a href="javascript:void(0)" data-bs-toggle="dropdown" class="dropdown-toggle">
                                   @if (!string.IsNullOrEmpty(Model.Avatar))
                                        {
                                            <img class="avatar-md rounded-circle"
                                                 src="@(Model.Avatar.StartsWith("http") ? Model.Avatar : $"{Context.Request.Scheme}://{Context.Request.Host}{Model.Avatar}")"
                                                 alt="@User.Identity!.Name" />
                                        }
                                        else
                                        {
                                            <img class="avatar-md rounded-circle" src="~/favicon.png" alt="@User.Identity!.Name" />
                                        }
                                    
							<span style="margin-left: 10px;">@User.Identity!.Name</span>
						</a>
						<ul class="dropdown-menu dropdown-menu-end">
							<li>
								<a class="multitabs dropdown-item" data-url="/Home/UserInfo"
									href="javascript:void(0)">
									<i class="mdi mdi-account"></i>
									<span>个人信息</span>
								</a>
							</li>
							<li>
                                <a class="multitabs dropdown-item" data-url="/Home/ResetPassword"
									href="javascript:void(0)">
									<i class="mdi mdi-lock-outline"></i>
									<span>修改密码</span>
								</a>
							</li>
							<li>
								<a class="dropdown-item" href="javascript:void(0)">
									<i class="mdi mdi-delete"></i>
									<span>清空缓存</span>
								</a>
							</li>
							<li class="dropdown-divider"></li>
							<li>
                                <a class="dropdown-item" href="/Authorize/Logout" >
									<i class="mdi mdi-logout-variant"></i>
									<span>退出登录</span>
								</a>
							</li>
						</ul>
					</li>
					<!--End 个人头像内容-->
				</ul>

			</nav>

		</header>
		<!--End 头部信息-->
		<!--页面主要内容-->
		<main class="lyear-layout-content">
			<div id="iframe-content">

			</div>
		</main>
		<!--End 页面主要内容-->
	</div>
</div>


